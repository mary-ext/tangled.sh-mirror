when:
  - event: ["push", "pull_request"]
    branch: master

engine: nixery

dependencies:
  nixpkgs:
    - go
    - gcc

steps:
  - name: patch static dir
    command: |
      mkdir -p appview/pages/static; touch appview/pages/static/x

  - name: run linter
    environment:
      CGO_ENABLED: 1
    command: |
      go vet -v ./...

  - name: run all tests
    environment:
      CGO_ENABLED: 1
    command: |
      go test -v ./...
